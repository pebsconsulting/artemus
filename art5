#!/usr/bin/perl

use Art5;

my $dump = 0;
my $v, $s;
my @path = ();

# raw argument parsing
while ($v = shift(@ARGV)) {
	if ($v eq '-d') {
		$dump  = 1;
	}
	elsif ($v eq '-I') {
		push(@path, shift(@ARGV));
	}
	else {
		# script name
	}
}

if (!defined($s)) {
	$s = join('', <>);
}

my $a = Art5->new( path => \@path);

my $c = $a->compile($s);

if ($dump) {
	use Data::Dumper;

	print Dumper($c), "\n";
}
else {
	print $a->exec($c);
}

exit 0;
